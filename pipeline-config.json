{
  "version": "1.0.0",
  "steps": [
    {
      "id": "step1_geo_calibration",
      "name": "Geo Calibration",
      "description": "ÐÐµÐ¾Ð¼ÐµÑÑÐ¸ÑÐ½Ð° ÐºÐ°Ð»Ð¸Ð±ÑÐ°ÑÐ¸Ñ Ð½Ð° Ð¸ÑÐ¸ÑÐ° - Ð¾Ð¿ÑÐµÐ´ÐµÐ»ÑÐ½Ðµ Ð½Ð° ÐºÐ¾Ð¾ÑÐ´Ð¸Ð½Ð°ÑÐ½Ð° ÑÐ¸ÑÑÐµÐ¼Ð°",
      "order": 1,
      "enabled": false,
      "prompt": "",
      "modelSettings": {
        "provider": "openai",
        "model": "gpt-4o",
        "temperature": 0.3,
        "maxTokens": 2000,
        "topP": 0.9
      },
      "inputFrom": null,
      "outputTo": "step2a_structural_detector",
      "lastModified": "2025-11-29T13:40:09.597Z"
    },
    {
      "id": "step2a_structural_detector",
      "name": "Structural Detector",
      "description": "ÐÐµÑÐµÐºÑÐ¾Ñ Ð½Ð° ÑÑÑÑÐºÑÑÑÐ½Ð¸ Ð½Ð°ÑÐ¾Ð´ÐºÐ¸ - Ð»Ð°ÐºÑÐ½Ð¸, ÐºÑÐ¸Ð¿ÑÐ¸, Ð±ÑÐ°Ð·Ð´Ð¸",
      "order": 1,
      "enabled": false,
      "prompt": "",
      "modelSettings": {
        "provider": "openai",
        "model": "gpt-4o",
        "temperature": 0.3,
        "maxTokens": 4300,
        "topP": 0.9
      },
      "inputFrom": null,
      "outputTo": "step2b_pigment_rings_detector",
      "lastModified": "2025-11-29T13:40:19.773Z"
    },
    {
      "id": "step2b_pigment_rings_detector",
      "name": "Pigment & Rings Detector",
      "description": "ÐÐµÑÐµÐºÑÐ¾Ñ Ð½Ð° Ð¿Ð¸Ð³Ð¼ÐµÐ½ÑÐ°ÑÐ¸Ñ Ð¸ Ð¿ÑÑÑÑÐµÐ½Ð¸",
      "order": 2,
      "enabled": false,
      "prompt": "",
      "modelSettings": {
        "provider": "openai",
        "model": "gpt-4o",
        "temperature": 0.3,
        "maxTokens": 3000,
        "topP": 0.9
      },
      "inputFrom": "step2a_structural_detector",
      "outputTo": "step1_geo_calibration",
      "lastModified": "2025-11-29T13:40:23.591Z"
    },
    {
      "id": "step2c_consistency_validator",
      "name": "Consistency Validator",
      "description": "ÐÐ°Ð»Ð¸Ð´Ð°ÑÐ¾Ñ Ð·Ð° ÑÑÐ³Ð»Ð°ÑÑÐ²Ð°Ð½Ð¾ÑÑ Ð½Ð° Ð½Ð°ÑÐ¾Ð´ÐºÐ¸ÑÐµ",
      "order": 4,
      "enabled": false,
      "prompt": "",
      "modelSettings": {
        "provider": "openai",
        "model": "gpt-4o",
        "temperature": 0.2,
        "maxTokens": 2000,
        "topP": 0.9
      },
      "inputFrom": "step1_geo_calibration",
      "outputTo": "step3_mapper",
      "lastModified": "2025-11-29T13:40:28.218Z"
    },
    {
      "id": "step3_mapper",
      "name": "Zone Mapper",
      "description": "ÐÐ°Ð¿Ð¸ÑÐ°Ð½Ðµ Ð½Ð° Ð½Ð°ÑÐ¾Ð´ÐºÐ¸ÑÐµ ÐºÑÐ¼ Ð·Ð¾Ð½Ð¸ Ð¿Ð¾ v9 ÑÑÐµÐ¼Ð°ÑÐ°",
      "order": 5,
      "enabled": false,
      "prompt": "",
      "modelSettings": {
        "provider": "openai",
        "model": "gpt-4o",
        "temperature": 0.2,
        "maxTokens": 2000,
        "topP": 0.9
      },
      "inputFrom": "step2c_consistency_validator",
      "outputTo": "step5_frontend_report",
      "lastModified": "2025-11-29T13:40:34.211Z"
    },
    {
      "id": "step4_profile_builder",
      "name": "Profile Builder",
      "description": "ÐÐ·Ð³ÑÐ°Ð¶Ð´Ð°Ð½Ðµ Ð½Ð° Ð¿ÑÐ¾ÑÐ¸Ð» Ð½Ð° Ð¿Ð°ÑÐ¸ÐµÐ½ÑÐ°",
      "order": 7,
      "enabled": false,
      "prompt": "",
      "modelSettings": {
        "provider": "openai",
        "model": "gpt-4o",
        "temperature": 0.5,
        "maxTokens": 3000,
        "topP": 0.9
      },
      "inputFrom": "step5_frontend_report",
      "outputTo": "one",
      "lastModified": "2025-11-29T13:40:37.318Z"
    },
    {
      "id": "step5_frontend_report",
      "name": "Frontend Report Generator",
      "description": "ÐÐµÐ½ÐµÑÐ¸ÑÐ°Ð½Ðµ Ð½Ð° ÑÐ¸Ð½Ð°Ð»Ð½Ð¸Ñ ÑÐµÐ¿Ð¾ÑÑ Ð·Ð° ÑÑÐ¾Ð½ÑÐµÐ½Ð´Ð°",
      "order": 6,
      "enabled": false,
      "prompt": "",
      "modelSettings": {
        "provider": "openai",
        "model": "gpt-4o",
        "temperature": 0.7,
        "maxTokens": 4000,
        "topP": 0.9
      },
      "inputFrom": "step3_mapper",
      "outputTo": "step4_profile_builder",
      "lastModified": "2025-11-29T13:41:24.605Z"
    },
    {
      "id": "one",
      "name": "One",
      "description": "ÐÐ±Ñ Ð¿ÑÐ¾Ð¼Ð¿Ñ",
      "order": 8,
      "enabled": true,
      "prompt": "РОЛЯ: senior_iridologist_20y_experience | MODE: image+text | TASK: analyze {{side}} iris and return FINAL JSON for frontend\n\nВажен принцип:\nИзползвай собственото си знание по иридология. Правилата по-долу насочват, но НЕ ограничават. За този анализ е по-добре да откриеш повече реални знаци (дори с ниска тежест), отколкото да ги пропуснеш. Премахвай само явно артефактни.\n\nINPUT:\nIMG_ID = {{imageHash}}\nSIDE = {{side}} // \"L\" or \"R\"\nPATIENT:\nage = {{age}}\ngender = {{gender}}\nbmi = {{bmi}}\nweight_kg = {{weight}}\nheight_cm = {{height}}\ngoals = {{goals}}\nhealthStatus = {{healthStatus}}\ncomplaints = {{complaints}}\ndiet = {{dietaryHabits}}\nstress = {{stressLevel}}\nsleep_hours = {{sleepHours}}\nsleep_quality = {{sleepQuality}}\nactivity = {{activityLevel}}\nmedications = {{medications}}\nallergies = {{allergies}}\n\nDETERMINISM:\nSame IMG_ID + same PATIENT → same JSON output, без случайност.\n\nPHASE 0 – IMAGE (ВЪТРЕШНО):\nРаботи само върху ириса. Игнорирай зеница, склера, клепачи, мигли, грим, силни блясъци. Мислено приложи локално усилване на контраста (CLAHE-тип) и леко изостряне, за да виждаш по-ясно границите на зоните, влакна, лакуни, крипти, пръстени.\n\nPHASE 1 – ГЕОМЕТРИЯ И КООРДИНАТИ:\n1.1 Намери центъра на зеницата и лимбуса (външен ръб на ириса).\n1.2 Ъгъл 0° = 12:00 (горе), 90° = 3:00. Движи се по часовника 0–360.\n1.3 Зони по 30°:\n Zone1: 0–30   Zone2: 30–60   Zone3: 60–90\n Zone4: 90–120 Zone5: 120–150 Zone6: 150–180\n Zone7: 180–210 Zone8: 210–240 Zone9: 240–270\n Zone10: 270–300 Zone11: 300–330 Zone12: 330–360\n1.4 Радиални пръстени 1–12:\n ring1 = започва от ръба на зеницата; ring12 = близо до лимбуса.\n inner = rings 2–4\n middle = rings 5–7\n outer = rings 8–11\n\nPHASE 2 – ЗНАЦИ (СТРУКТУРА, ПИГМЕНТ, ПРЪСТЕНИ):\nСтруктурни знаци: lacuna, crypt, radial_furrow, transversal_fiber, nerve_ring, structural_asymmetry\nПигментни знаци: pigment_spot, pigment_cloud, pigment_band, lymphatic_rosary, scurf_rim, sodium_ring, ANW_anomaly\n\nЗа всеки открит знак определи:\n- angle (0–360),\n- zone (1–12),\n- radial: \"inner\" / \"middle\" / \"outer\",\n- type (от списъка),\n- visual weight: \"low\" / \"medium\" / \"high\".\n\nPHASE 3 – КОНСИСТЕНТНОСТ:\n- Слей дубликати.\n- max 40 знака общо.\n- Премахвай само явни артефакти.\n\nPHASE 4 – ОРГАННИ ЗОНИ (по SIDE L/R):\nZone1: мозък и ЦНС | Zone2: щитовидна жлеза | Zone3: бял дроб | Zone4: сърце\nZone5: черен дроб/далак | Zone6: стомах и панкреас | Zone7: тънки черва\nZone8: дебело черво | Zone9: урогенитална област | Zone10: бъбрек\nZone11: гръбнак и стави | Zone12: автономна регулация\n\nPHASE 5 – PROFIL:\n- constitution, disposition, diathesis, anwStatus\n- axes: stress, digestive, immune (0–100)\n- eliminationChannels (до 4)\n\nPHASE 6 – КОРЕЛАЦИЯ с въпросник:\n- High priority: знак + зона съвпадат с оплаквания\n- Medium: ясни знаци без оплаквания\n- Low: противоречия\n\nPHASE 7 – JSON ИЗХОД:\n{\n  \"analysis\": {\n    \"imgId\": \"{{imageHash}}\",\n    \"side\": \"{{side}}\",\n    \"constitution\": \"описание_БГ\",\n    \"disposition\": \"описание_БГ\",\n    \"diathesis\": \"описание_БГ\",\n    \"anwStatus\": \"описание_БГ\",\n    \"zones\": [\n      {\n        \"id\": 1,\n        \"name\": \"зона_БГ\",\n        \"organ\": \"орган_БГ\",\n        \"status\": \"normal|attention|concern\",\n        \"findings\": \"кратко_БГ<=60\",\n        \"angle\": [0, 30]\n      }\n    ],\n    \"artifacts\": [\n      {\n        \"type\": \"тип_БГ\",\n        \"location\": \"3:00-4:00\",\n        \"description\": \"опис_БГ<=60\",\n        \"severity\": \"low|medium|high\"\n      }\n    ],\n    \"axes\": {\n      \"stress\": 40,\n      \"digestive\": 70,\n      \"immune\": 55\n    },\n    \"eliminationChannels\": [\n      {\n        \"channel\": \"канал_БГ\",\n        \"status\": \"нормален|натоварен|уязвим\",\n        \"note\": \"бележка_БГ\"\n      }\n    ],\n    \"overallHealth\": 75,\n    \"systemScores\": [\n      {\"system\": \"Храносмилателна\", \"score\": 80, \"description\": \"описание_БГ<=60\"},\n      {\"system\": \"Имунна\", \"score\": 80, \"description\": \"описание_БГ<=60\"},\n      {\"system\": \"Нервна\", \"score\": 80, \"description\": \"описание_БГ<=60\"},\n      {\"system\": \"Сърдечно-съдова\", \"score\": 80, \"description\": \"описание_БГ<=60\"},\n      {\"system\": \"Детоксикация\", \"score\": 80, \"description\": \"описание_БГ<=60\"},\n      {\"system\": \"Ендокринна\", \"score\": 80, \"description\": \"описание_БГ<=60\"}\n    ],\n    \"hypotheses\": [\n      {\n        \"title\": \"заглавие_БГ\",\n        \"claim\": \"твърдение_БГ\",\n        \"evidenceSummary\": \"обяснение_БГ\",\n        \"confidence\" : 0.0,\n        \"applicability\": \"приложимост_БГ\"\n      }\n    ],\n    \"verificationQuestions\": [\"въпрос_БГ\"]\n  }\n}\n",
      "modelSettings": {
        "provider": "openai",
        "model": "gpt-4o",
        "temperature": 0.5,
        "maxTokens": 3000,
        "topP": 0.9
      },
      "inputFrom": "step5_frontend_report",
      "outputTo": null,
      "lastModified": "2025-12-01T00:30:54.901Z"
    }
  ],
  "lastModified": "2025-12-01T00:30:57.664Z"
}